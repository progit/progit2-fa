[[_perforce_import]]
==== پر فورس

(((Perforce)))(((Importing, from Perforce)))
سیستم بعدی که به آن نگاه خواهید کرد وارد کردن از پر فورس است.
        همانطور که در بالا بحث کردیم، دو راه برای ارتباط گیت و پر فورس وجود دارد: git-p4 و Perforce Git Fusion.

===== Perforce Git Fusion

گیت فیوژن این فرآیند را نسبتاً بدون دردسر می‌کند.
          فقط تنظیمات پروژه، نگاشت‌های کاربر و شاخه‌ها را با استفاده از یک فایل پیکربندی تنظیم کنید (همانطور که در <<_p4_git_fusion#_p4_git_fusion>> بحث شد)، و مخزن را کلون کنید.
          گیت فیوژن به شما چیزی می‌دهد که به نظر می‌رسد یک مخزن گیت بومی است، که سپس آماده است تا به یک میزبان گیت بومی
          فشار داده شود اگر بخواهید.
          شما حتی می‌توانید از پر فورس به عنوان میزبان گیت خود استفاده کنید اگر بخواهید.

[[_git_p4]]
===== گیت-p4

گیت-p4 همچنین می‌تواند به عنوان یک ابزار واردات عمل کند.
          به عنوان مثال، ما پروژه Jam را از مخزن عمومی پر فورس وارد خواهیم کرد.
          برای تنظیم مشتری خود، باید متغیر محیط P4PORT را برای اشاره به مخزن پر فورس صادر کنید:

[source,console]
----
$ export P4PORT=public.perforce.com:1666
----

[NOTE]
====
برای پیروی از این روند، شما به یک مخزن پر فورس نیاز دارید که به آن متصل شوید.
                  ما از مخزن عمومی در public.perforce.com برای مثال‌های خود استفاده خواهیم کرد، اما می‌توانید از هر
                  مخزنی که به آن دسترسی دارید استفاده کنید.
====

(((git commands, p4)))
دستور `git p4 clone` را برای وارد کردن پروژه Jam از سرور پر فورس اجرا کنید، با ارائه مسیر مخزن و
          پروژه و مسیری که می‌خواهید پروژه را در آن وارد کنید:

[source,console]
----
$ git-p4 clone //guest/perforce_software/jam@all p4import
Importing from //guest/perforce_software/jam@all into p4import
Initialized empty Git repository in /private/tmp/p4import/.git/
Import destination: refs/remotes/p4/master
Importing revision 9957 (100%)
----

این پروژه خاص فقط یک شاخه دارد، اما اگر شما شاخه‌هایی دارید که با نمای شاخه پیکربندی شده‌اند (یا فقط یک
          مجموعه از دایرکتوری‌ها)، می‌توانید از پرچم `--detect-branches` برای `git p4 clone`
          استفاده کنید تا تمام شاخه‌های پروژه را نیز وارد کنید.
          برای جزئیات بیشتر به <<_git_p4_branches#_git_p4_branches>> مراجعه کنید.

در این مرحله تقریباً کارتان تمام است.
          اگر به دایرکتوری `p4import` بروید و `git log` را اجرا کنید، می‌توانید کار وارد شده خود
          را ببینید:

[source,console]
----
$ git log -2
commit e5da1c909e5db3036475419f6379f2c73710c4e6
Author: giles <giles@giles@perforce.com>
Date:   Wed Feb 8 03:13:27 2012 -0800

    Correction to line 355; change </UL> to </OL>.

    [git-p4: depot-paths = "//public/jam/src/": change = 8068]

commit aa21359a0a135dda85c50a7f7cf249e4f7b8fd98
Author: kwirth <kwirth@perforce.com>
Date:   Tue Jul 7 01:35:51 2009 -0800

    Fix spelling error on Jam doc page (cummulative -> cumulative).

    [git-p4: depot-paths = "//public/jam/src/": change = 7304]
----

شما می‌توانید ببینید که `git-p4` یک شناسه در هر پیام کامیت باقی گذاشته است.
          نگه داشتن آن شناسه خوب است، در صورتی که بخواهید بعداً شماره تغییر پر فورس را ارجاع دهید.
          با این حال، اگر می‌خواهید شناسه را حذف کنید، اکنون زمان آن است که این کار را انجام دهید – قبل از اینکه شروع به
          کار بر روی مخزن جدید کنید.
          
          شما می‌توانید از `git filter-branch` برای حذف رشته‌های شناسه به صورت انبوه استفاده کنید:

[source,console]
----
$ git filter-branch --msg-filter 'sed -e "/^\[git-p4:/d"'
Rewrite e5da1c909e5db3036475419f6379f2c73710c4e6 (125/125)
Ref 'refs/heads/master' was rewritten
----

اگر `git log` را اجرا کنید، می‌توانید ببینید که تمام checksum‌های SHA-1 برای کامیت‌ها تغییر
          کرده‌اند، اما رشته‌های `git-p4` دیگر در پیام‌های کامیت وجود ندارند:

[source,console]
----
$ git log -2
commit b17341801ed838d97f7800a54a6f9b95750839b7
Author: giles <giles@giles@perforce.com>
Date:   Wed Feb 8 03:13:27 2012 -0800

    Correction to line 355; change </UL> to </OL>.

commit 3e68c2e26cd89cb983eb52c024ecdfba1d6b3fff
Author: kwirth <kwirth@perforce.com>
Date:   Tue Jul 7 01:35:51 2009 -0800

    Fix spelling error on Jam doc page (cummulative -> cumulative).
----

واردات شما آماده است تا به سرور گیت جدید خود فشار داده شود.
